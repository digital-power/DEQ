/*! @preserve Digital Event Queue - 2.0.0 core - https://github.com/digital-power/DEQ */
"function"!=typeof DigitalEventQueue&&(window.DigitalEventQueue=function DigitalEventQueue(e,t){"use strict";if(DigitalEventQueue.queue[e])return DigitalEventQueue.queue[e];var i=DigitalEventQueue.queue[e]=this;i.version="2.0.0 core",i.name=e,i.listeners=[],i.events=[],i.history=[],i.global={},i.push=function(e){if(i.history.push(e),r(e)&&e.command)switch(e.command){case"ADD EVENT":d(e);break;case"ADD LISTENER":n(e);break;case"GLOBAL DATA":l(e);break;default:s("push","unknown command: "+e.command,{input:e})}else s("push","invalid input",{input:e})},i.unshift=i.push;function a(t,n){try{var e={name:t[0],data:t[1]},a={name:n[0],matchEvent:n[1],handler:n[2]},r=new RegExp("^"+a.matchEvent+"$","i");!e.name.match(r)||e.name.match(/^deq error$/i)&&".*"==a.matchEvent||function(t,e,n,a){try{n.call(n,t,c(e),i)}catch(e){"deq error"!=t&&s("listener","listener ("+a+") failed on '"+t,e,t,a)}}(e.name,e.data,a.handler,a.name)}catch(e){s("checkAndExecuteEventMatch",e.message,{event:t,listener:n,error:e})}}var r=function(e){return"[object Object]"==Object.prototype.toString.call(e)},o=function(){var n={};return[].splice.call(arguments,0).forEach(function(t){r(t)&&Object.keys(t).forEach(function(e){r(n[e])&&r(t[e])?n[e]=o(n[e],t[e]):n[e]=u(t[e])})}),n},u=function(e){if(r(e))return c(e);if(Array.isArray(e)){var t=[];return e.forEach(function(e){t.push(u(e))}),t}return e},c=function(e){return o(e)},s=function(e,t,n,a,r){n=n||{},i.push({command:"ADD EVENT",name:"deq error",data:{deq_error_type:e,deq_error_message:t,deq_error_obj:n,deq_error_event:a,deq_error_listener:r}})},n=function(e){var t;r(e)&&"function"==typeof e.handler&&"string"==typeof e.matchEvent?(e.name=e.name||"unnamed listener",t=[e.name,e.matchEvent,e.handler],i.listeners.push(t),e.skipHistory||i.events.forEach(function(e){a(e,t)})):s("add listener","invalid input",{input:e})},d=function(t){if("string"!=typeof t.name||void 0!==t.data&&!r(t.data))s("add event","invalid input",{input:t});else try{var e=o(i.global,t.data,{deq_event:t.name,deq_event_ts:(new Date).getTime()}),n=[t.name,e];i.events.push(n),i.listeners.forEach(function(e){a(n,e)})}catch(e){s("add event","invalid event object",e,t.name)}},l=function(e){r(e.data)&&(i.global=o(i.global,e.data))};Object.getPrototypeOf(i).constructor===DigitalEventQueue&&Array.isArray(t)&&t.forEach(function(e){i.push(e)})},DigitalEventQueue.prototype=[],DigitalEventQueue.prototype.constructor=DigitalEventQueue,DigitalEventQueue.queue={});